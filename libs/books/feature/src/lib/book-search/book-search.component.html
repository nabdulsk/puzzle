<form [formGroup]="searchForm" (submit)="searchBooks()">
  <mat-form-field floatLabel="never">
    <input
      id="searchInput"
      autoFocus
      matInput
      type="search"
      placeholder="Search for books to add to your reading list"
      formControlName="term"
      (keyup)="checkSearchKey()"
      />
    <button
      mat-icon-button
      matSuffix
      id="btnSearch"
      aria-label="search">
      <mat-icon aria-hidden="true">search</mat-icon>
    </button>
  </mat-form-field>
</form>

<ng-container *ngIf="searchTerm; else empty">
  <div
    fxLayout="row wrap"
    fxLayoutGap="32px"
    fxLayoutAlign="center"
    class="container book-grid"
    *ngIf="(books$ | async)?.length> 0">

    <div
      fxFlex="45"
      fxFlex.lt-md="100%"
      fxFlex.lt-sm="100%"
      class="book"
      data-testing="book-item"
      *ngFor="let book of books$ | async;">

      <mat-card class="card">
        <mat-card-title fxLayout.gt-xs="row" fxLayout.xs="column">
          {{ book?.title }}
        </mat-card-title>
        <mat-card-content class="book--content">
          <div class="book--content--cover">
            <img src="{{ book?.coverUrl }}" [alt]="book?.title" />
          </div>
          <div class="book--content--info">
            <div><strong>Author:</strong> {{ book?.authors.join(',') }}</div>
            <div><strong>Publisher:</strong> {{ book?.publisher }}</div>
            <div>
              <strong>Published:</strong> {{ formatDate(book?.publishedDate) }}
            </div>
            <p [innerHTML]="book?.description"></p>
            <mat-card-actions>
              <button
                mat-flat-button
                color="primary"
                (click)="addBookToReadingList(book)"
                id="wantToRead-{{book?.id}}"
                [attr.aria-label]="'Add ' + book?.title + ' to reading list'"
                [attr.aria-disabled]="book?.isAdded"
                [disabled]="book?.isAdded">
                Want to Read
              </button>
            </mat-card-actions>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</ng-container>
<ng-template #empty>
  <div class="empty">
    <p>
      Try searching for a topic, for example "<a aria-label="Search for
        javascript books to add to your reading list" tabindex="0"
        (click)="searchExample()">JavaScript</a>"
      .
    </p>
  </div>
</ng-template>

<div class="spinner-container" *ngIf="(loader$ | async) === false">
  <mat-progress-spinner
    [color]="loaderConfig.color"
    [mode]="loaderConfig.mode"
    [value]="loaderConfig.value">
  </mat-progress-spinner>
</div>

<div class="error-container">
  <mat-error id="errorMsg" *ngIf="error$ | async as error">
    Books are not available with the given search input
  </mat-error>
</div>